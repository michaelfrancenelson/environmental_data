---
title: "Terrain and basal area scatterplots"
output:  
  html_document:
    theme: readable
    css: !expr here::here("formatting", "css", "styles.css")
    toc: TRUE
    toc_float: TRUE
editor_options: 
  chunk_output_type: console
---



Question
========

```{r CSS, echo = FALSE, results = "asis"}
cat(readLines(here::here("formatting", "css", "styles.css")))
```

Instructions:

1.  Create scatterplots of *total basal area* and each of the the terrain variables: elevation, slope, and aspect. 
- Basal area should be on the y-axis.
2. Visually inspect the plots and fit a *linear function* to each terrain variable.  
- Review the linear model parameterization section of the assignment walkthrough if needed.


<div class="hintborder">


- Hint: you can use `par(mfrow = c(3, 1))` to create a figure with three panels arranged in a single column.
- Hint: `par(mfrow = c(1, 3))` will create a figure with three panels arranged in a single row.
- Hint: Choose dimensions for your output file so that the individual scatterplots have an appropriate aspect ratio.
- Hint: There are many points, some of which partially overlap, in the scatterplots.  You may want to experiment with the size of individual points to see if you can find an optimal size that allows you to see all of them.  Try different values of the `cex` argument in your `plot()` call.
- Hint: Choose a different color for your lines.  Experiment with the `col` argument to `plot()`.

</div>





<div class="questionborder">

### Q1 3 pts

- Upload a single image file containing your figure.

</div>


Solution
========

```{r terrain_scatterplots, fig.asp=1/3}
line_point_slope = function(x, x1, y1, slope)
{
  get_y_intercept = 
    function(x1, y1, slope) 
      return(-(x1 * slope) + y1)
  
  linear = 
    function(x, yint, slope) 
      return(yint + x * slope)
  
  return(linear(x, get_y_intercept(x1, y1, slope), slope))
}

dat_bird = read.csv(here::here("data", "bird.sta.csv"))
dat_habitat = read.csv(here::here("data", "hab.sta.csv"))
dat_all = merge(dat_bird, dat_habitat)

pch = 16
line_col = rgb(.7, .1, .1, 1); line_lwd = 4.9
p_col = rgb(0, 0.4, 0.1, 0.2)
{
  par(mfrow = c(1, 3), pch = 16)
  # par(mfrow = c(1, 3), pch = 16, lwd = line_lwd)
  # par(mfrow = c(1, 3), pch = 16, col = p_col, lwd = line_lwd)
  plot(
    ba.tot ~ elev, data = dat_all, col = p_col,
    main = "Basal area and elevation", ylab = "Total Basal Area")
  curve(line_point_slope(x, 400, 25, 0.04), col = line_col, lwd = line_lwd, add = TRUE)
  plot(
    ba.tot ~ slope, data = dat_all, col = p_col,
    main = "Basal area and slope", ylab = "Total Basal Area")
  curve(line_point_slope(x, 50, 25, 0.4), col = line_col, lwd = line_lwd, add = TRUE)
  plot(
    ba.tot ~ aspect, data = dat_all, col = p_col,
    main = "Basal area and aspect", ylab = "Total Basal Area")
  curve(line_point_slope(x, 200, 25, 0.01), col = line_col, lwd = line_lwd, add = TRUE)
}

```

Meta-information
================
extitle: Terrain and basal area scatterplots
extype: string
exsolution: nil
exname: data exploration det. funs
exsection: data exploration det. funs
exextra[essay,logical]: TRUE
exextra[essay_format,character]: editor
exextra[essay_required,logical]: TRUE
exextra[essay_fieldlines,numeric]: 5
exextra[essay_attachments,numeric]: 1
exextra[essay_attachmentsrequired,logical]: TRUE
expoints: 3
